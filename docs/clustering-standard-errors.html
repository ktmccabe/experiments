<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7.2 Clustering standard errors | Experimental Methods in Political Science</title>
  <meta name="description" content="7.2 Clustering standard errors | Experimental Methods in Political Science" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="7.2 Clustering standard errors | Experimental Methods in Political Science" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7.2 Clustering standard errors | Experimental Methods in Political Science" />
  
  
  

<meta name="author" content="Instructor: Katie McCabe" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="field-experiment-application.html"/>
<link rel="next" href="compliance.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<link href="libs/vembedr-0.1.4/css/vembedr.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Course Notes</a>
<ul>
<li class="chapter" data-level="1.1" data-path="rsetup.html"><a href="rsetup.html"><i class="fa fa-check"></i><b>1.1</b> Setup in R</a></li>
<li class="chapter" data-level="1.2" data-path="first-time-working-in-r-and-rstudio.html"><a href="first-time-working-in-r-and-rstudio.html"><i class="fa fa-check"></i><b>1.2</b> First Time Working in R and RStudio</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="first-time-working-in-r-and-rstudio.html"><a href="first-time-working-in-r-and-rstudio.html#open-rstudio"><i class="fa fa-check"></i><b>1.2.1</b> Open RStudio</a></li>
<li class="chapter" data-level="1.2.2" data-path="first-time-working-in-r-and-rstudio.html"><a href="first-time-working-in-r-and-rstudio.html#using-r-as-a-calculator"><i class="fa fa-check"></i><b>1.2.2</b> Using R as a Calculator</a></li>
<li class="chapter" data-level="1.2.3" data-path="first-time-working-in-r-and-rstudio.html"><a href="first-time-working-in-r-and-rstudio.html#working-in-an-r-script"><i class="fa fa-check"></i><b>1.2.3</b> Working in an R Script</a></li>
<li class="chapter" data-level="1.2.4" data-path="first-time-working-in-r-and-rstudio.html"><a href="first-time-working-in-r-and-rstudio.html#preparing-your-r-script"><i class="fa fa-check"></i><b>1.2.4</b> Preparing your R script</a></li>
<li class="chapter" data-level="1.2.5" data-path="first-time-working-in-r-and-rstudio.html"><a href="first-time-working-in-r-and-rstudio.html#executing-commands-in-your-r-script"><i class="fa fa-check"></i><b>1.2.5</b> Executing Commands in your R script</a></li>
<li class="chapter" data-level="1.2.6" data-path="first-time-working-in-r-and-rstudio.html"><a href="first-time-working-in-r-and-rstudio.html#objects"><i class="fa fa-check"></i><b>1.2.6</b> Objects</a></li>
<li class="chapter" data-level="1.2.7" data-path="first-time-working-in-r-and-rstudio.html"><a href="first-time-working-in-r-and-rstudio.html#practice-with-r-scripts"><i class="fa fa-check"></i><b>1.2.7</b> Practice with R Scripts</a></li>
<li class="chapter" data-level="1.2.8" data-path="first-time-working-in-r-and-rstudio.html"><a href="first-time-working-in-r-and-rstudio.html#loading-data-into-r"><i class="fa fa-check"></i><b>1.2.8</b> Loading data into R</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>1.3</b> R Markdown</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="r-markdown.html"><a href="r-markdown.html#how-to-get-setup-in-rmarkdown"><i class="fa fa-check"></i><b>1.3.1</b> How to get setup in RMarkdown</a></li>
<li class="chapter" data-level="1.3.2" data-path="r-markdown.html"><a href="r-markdown.html#additional-rmarkdown-resources"><i class="fa fa-check"></i><b>1.3.2</b> Additional RMarkdown resources</a></li>
<li class="chapter" data-level="1.3.3" data-path="r-markdown.html"><a href="r-markdown.html#practice-with-r-markdown"><i class="fa fa-check"></i><b>1.3.3</b> Practice with R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="what-are-experiments.html"><a href="what-are-experiments.html"><i class="fa fa-check"></i><b>1.4</b> What are experiments?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="causaleffects.html"><a href="causaleffects.html"><i class="fa fa-check"></i><b>2</b> Causal Effects</a>
<ul>
<li class="chapter" data-level="2.1" data-path="potential-outcomes-framework.html"><a href="potential-outcomes-framework.html"><i class="fa fa-check"></i><b>2.1</b> Potential Outcomes Framework</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="potential-outcomes-framework.html"><a href="potential-outcomes-framework.html#average-treatment-effect"><i class="fa fa-check"></i><b>2.1.1</b> Average Treatment Effect</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="fundamental-problem-of-causal-inference.html"><a href="fundamental-problem-of-causal-inference.html"><i class="fa fa-check"></i><b>2.2</b> Fundamental Problem of Causal Inference</a></li>
<li class="chapter" data-level="2.3" data-path="identification-strategy.html"><a href="identification-strategy.html"><i class="fa fa-check"></i><b>2.3</b> Identification strategy</a></li>
<li class="chapter" data-level="2.4" data-path="difference-in-means-estimator.html"><a href="difference-in-means-estimator.html"><i class="fa fa-check"></i><b>2.4</b> Difference in Means Estimator</a></li>
<li class="chapter" data-level="2.5" data-path="overview-of-identification-assumptions.html"><a href="overview-of-identification-assumptions.html"><i class="fa fa-check"></i><b>2.5</b> Overview of identification assumptions</a></li>
<li class="chapter" data-level="2.6" data-path="application-in-r.html"><a href="application-in-r.html"><i class="fa fa-check"></i><b>2.6</b> Application in R</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="application-in-r.html"><a href="application-in-r.html#loading-the-data"><i class="fa fa-check"></i><b>2.6.1</b> Loading the data</a></li>
<li class="chapter" data-level="2.6.2" data-path="application-in-r.html"><a href="application-in-r.html#variable-classes"><i class="fa fa-check"></i><b>2.6.2</b> Variable classes</a></li>
<li class="chapter" data-level="2.6.3" data-path="application-in-r.html"><a href="application-in-r.html#exploring-treatment-and-control-groups"><i class="fa fa-check"></i><b>2.6.3</b> Exploring Treatment and Control Groups</a></li>
<li class="chapter" data-level="2.6.4" data-path="application-in-r.html"><a href="application-in-r.html#means-with-relational-operators"><i class="fa fa-check"></i><b>2.6.4</b> Means with Relational Operators</a></li>
<li class="chapter" data-level="2.6.5" data-path="application-in-r.html"><a href="application-in-r.html#means-with-tidyverse"><i class="fa fa-check"></i><b>2.6.5</b> Means with <code>tidyverse</code></a></li>
<li class="chapter" data-level="2.6.6" data-path="application-in-r.html"><a href="application-in-r.html#ate-with-linear-regression"><i class="fa fa-check"></i><b>2.6.6</b> ATE with linear regression</a></li>
<li class="chapter" data-level="2.6.7" data-path="application-in-r.html"><a href="application-in-r.html#subsetting-data-in-r"><i class="fa fa-check"></i><b>2.6.7</b> Subsetting data in R</a></li>
<li class="chapter" data-level="2.6.8" data-path="application-in-r.html"><a href="application-in-r.html#additional-practice"><i class="fa fa-check"></i><b>2.6.8</b> Additional Practice</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="design.html"><a href="design.html"><i class="fa fa-check"></i><b>3</b> Experimental Design</a>
<ul>
<li class="chapter" data-level="3.1" data-path="designing-an-experiment.html"><a href="designing-an-experiment.html"><i class="fa fa-check"></i><b>3.1</b> Designing an Experiment</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="designing-an-experiment.html"><a href="designing-an-experiment.html#validity"><i class="fa fa-check"></i><b>3.1.1</b> Validity</a></li>
<li class="chapter" data-level="3.1.2" data-path="designing-an-experiment.html"><a href="designing-an-experiment.html#design-space-for-experiments"><i class="fa fa-check"></i><b>3.1.2</b> Design Space for Experiments</a></li>
<li class="chapter" data-level="3.1.3" data-path="designing-an-experiment.html"><a href="designing-an-experiment.html#types-of-designs"><i class="fa fa-check"></i><b>3.1.3</b> Types of Designs</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="using-qualtrics.html"><a href="using-qualtrics.html"><i class="fa fa-check"></i><b>3.2</b> Using Qualtrics</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="using-qualtrics.html"><a href="using-qualtrics.html#experimental-design-with-vignette-experiment"><i class="fa fa-check"></i><b>3.2.1</b> Experimental Design with Vignette Experiment</a></li>
<li class="chapter" data-level="3.2.2" data-path="using-qualtrics.html"><a href="using-qualtrics.html#unique-blocks-per-experimental-condition"><i class="fa fa-check"></i><b>3.2.2</b> Unique blocks per experimental condition</a></li>
<li class="chapter" data-level="3.2.3" data-path="using-qualtrics.html"><a href="using-qualtrics.html#adding-a-randomizer-in-the-survey-flow"><i class="fa fa-check"></i><b>3.2.3</b> Adding a randomizer in the survey flow</a></li>
<li class="chapter" data-level="3.2.4" data-path="using-qualtrics.html"><a href="using-qualtrics.html#using-piped-text-in-randomization"><i class="fa fa-check"></i><b>3.2.4</b> Using Piped Text in Randomization</a></li>
<li class="chapter" data-level="3.2.5" data-path="using-qualtrics.html"><a href="using-qualtrics.html#data-and-analysis"><i class="fa fa-check"></i><b>3.2.5</b> Data and Analysis</a></li>
<li class="chapter" data-level="3.2.6" data-path="using-qualtrics.html"><a href="using-qualtrics.html#additional-bells-and-whistles"><i class="fa fa-check"></i><b>3.2.6</b> Additional Bells and Whistles</a></li>
<li class="chapter" data-level="3.2.7" data-path="using-qualtrics.html"><a href="using-qualtrics.html#adding-a-gif-to-qualtrics"><i class="fa fa-check"></i><b>3.2.7</b> Adding a gif to Qualtrics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="uncertainty.html"><a href="uncertainty.html"><i class="fa fa-check"></i><b>4</b> Uncertainty</a>
<ul>
<li class="chapter" data-level="4.1" data-path="standard-errors.html"><a href="standard-errors.html"><i class="fa fa-check"></i><b>4.1</b> Standard Errors</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="standard-errors.html"><a href="standard-errors.html#standard-error-of-the-mean"><i class="fa fa-check"></i><b>4.1.1</b> Standard Error of the Mean</a></li>
<li class="chapter" data-level="4.1.2" data-path="standard-errors.html"><a href="standard-errors.html#standard-error-for-a-difference-in-means"><i class="fa fa-check"></i><b>4.1.2</b> Standard error for a difference in means</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="confidence-intervals.html"><a href="confidence-intervals.html"><i class="fa fa-check"></i><b>4.2</b> Confidence Intervals</a></li>
<li class="chapter" data-level="4.3" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html"><i class="fa fa-check"></i><b>4.3</b> Hypothesis Tests</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#t-tests"><i class="fa fa-check"></i><b>4.3.1</b> t-tests</a></li>
<li class="chapter" data-level="4.3.2" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#p-values"><i class="fa fa-check"></i><b>4.3.2</b> p-values</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="empirical-application.html"><a href="empirical-application.html"><i class="fa fa-check"></i><b>4.4</b> Empirical Application</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="empirical-application.html"><a href="empirical-application.html#treatment"><i class="fa fa-check"></i><b>4.4.1</b> Treatment</a></li>
<li class="chapter" data-level="4.4.2" data-path="empirical-application.html"><a href="empirical-application.html#analysis"><i class="fa fa-check"></i><b>4.4.2</b> Analysis</a></li>
<li class="chapter" data-level="4.4.3" data-path="empirical-application.html"><a href="empirical-application.html#heterogeneous-treatment-effects"><i class="fa fa-check"></i><b>4.4.3</b> Heterogeneous Treatment Effects</a></li>
<li class="chapter" data-level="4.4.4" data-path="empirical-application.html"><a href="empirical-application.html#difference-in-proportions"><i class="fa fa-check"></i><b>4.4.4</b> Difference in Proportions</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="randomization-inference.html"><a href="randomization-inference.html"><i class="fa fa-check"></i><b>4.5</b> Randomization Inference</a></li>
<li class="chapter" data-level="4.6" data-path="a-note-on-expectations-and-variance.html"><a href="a-note-on-expectations-and-variance.html"><i class="fa fa-check"></i><b>4.6</b> A Note on Expectations and Variance</a></li>
<li class="chapter" data-level="4.7" data-path="equivalence-of-t-test-and-anova.html"><a href="equivalence-of-t-test-and-anova.html"><i class="fa fa-check"></i><b>4.7</b> Equivalence of t-test and ANOVA</a></li>
<li class="chapter" data-level="4.8" data-path="experimental-design-complications.html"><a href="experimental-design-complications.html"><i class="fa fa-check"></i><b>4.8</b> Experimental Design Complications</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="visualize.html"><a href="visualize.html"><i class="fa fa-check"></i><b>5</b> Visualization</a>
<ul>
<li class="chapter" data-level="5.1" data-path="plotting-average-treatment-effects.html"><a href="plotting-average-treatment-effects.html"><i class="fa fa-check"></i><b>5.1</b> Plotting Average Treatment Effects</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="plotting-average-treatment-effects.html"><a href="plotting-average-treatment-effects.html#ate-using-plot"><i class="fa fa-check"></i><b>5.1.1</b> ATE using <code>plot</code></a></li>
<li class="chapter" data-level="5.1.2" data-path="plotting-average-treatment-effects.html"><a href="plotting-average-treatment-effects.html#ate-with-ggplot"><i class="fa fa-check"></i><b>5.1.2</b> ATE with <code>ggplot</code></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="heterogeneous-treatment-effects-1.html"><a href="heterogeneous-treatment-effects-1.html"><i class="fa fa-check"></i><b>5.2</b> Heterogeneous Treatment Effects</a></li>
<li class="chapter" data-level="5.3" data-path="some-additional-plotting-options.html"><a href="some-additional-plotting-options.html"><i class="fa fa-check"></i><b>5.3</b> Some additional plotting options</a></li>
<li class="chapter" data-level="5.4" data-path="examples-of-arguments-in-plot.html"><a href="examples-of-arguments-in-plot.html"><i class="fa fa-check"></i><b>5.4</b> Examples of arguments in <code>plot</code></a></li>
<li class="chapter" data-level="5.5" data-path="creating-tables-from-r.html"><a href="creating-tables-from-r.html"><i class="fa fa-check"></i><b>5.5</b> Creating Tables from R</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="creating-tables-from-r.html"><a href="creating-tables-from-r.html#additional-formatting-examples"><i class="fa fa-check"></i><b>5.5.1</b> Additional formatting examples</a></li>
<li class="chapter" data-level="5.5.2" data-path="creating-tables-from-r.html"><a href="creating-tables-from-r.html#additional-table-types"><i class="fa fa-check"></i><b>5.5.2</b> Additional Table Types</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ethics.html"><a href="ethics.html"><i class="fa fa-check"></i><b>6</b> Ethics and Sampling Considerations</a>
<ul>
<li class="chapter" data-level="6.1" data-path="value-of-informed-consent.html"><a href="value-of-informed-consent.html"><i class="fa fa-check"></i><b>6.1</b> Value of Informed Consent</a></li>
<li class="chapter" data-level="6.2" data-path="research-integrity-reproducibility-and-transparency.html"><a href="research-integrity-reproducibility-and-transparency.html"><i class="fa fa-check"></i><b>6.2</b> Research Integrity, Reproducibility, and Transparency</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="research-integrity-reproducibility-and-transparency.html"><a href="research-integrity-reproducibility-and-transparency.html#preregistration"><i class="fa fa-check"></i><b>6.2.1</b> Preregistration</a></li>
<li class="chapter" data-level="6.2.2" data-path="research-integrity-reproducibility-and-transparency.html"><a href="research-integrity-reproducibility-and-transparency.html#reporting-an-experimental-analysis"><i class="fa fa-check"></i><b>6.2.2</b> Reporting an Experimental Analysis</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="sampling-considerations.html"><a href="sampling-considerations.html"><i class="fa fa-check"></i><b>6.3</b> Sampling Considerations</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="sampling-considerations.html"><a href="sampling-considerations.html#power-analysis"><i class="fa fa-check"></i><b>6.3.1</b> Power Analysis</a></li>
<li class="chapter" data-level="6.3.2" data-path="sampling-considerations.html"><a href="sampling-considerations.html#power-in-r"><i class="fa fa-check"></i><b>6.3.2</b> Power in R</a></li>
<li class="chapter" data-level="6.3.3" data-path="sampling-considerations.html"><a href="sampling-considerations.html#relationship-between-error-rates-and-multiple-testing"><i class="fa fa-check"></i><b>6.3.3</b> Relationship between Error Rates and Multiple Testing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="fieldexp.html"><a href="fieldexp.html"><i class="fa fa-check"></i><b>7</b> Field Experiments</a>
<ul>
<li class="chapter" data-level="7.1" data-path="field-experiment-application.html"><a href="field-experiment-application.html"><i class="fa fa-check"></i><b>7.1</b> Field Experiment Application</a></li>
<li class="chapter" data-level="7.2" data-path="clustering-standard-errors.html"><a href="clustering-standard-errors.html"><i class="fa fa-check"></i><b>7.2</b> Clustering standard errors</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="clustering-standard-errors.html"><a href="clustering-standard-errors.html#adjusting-p-values"><i class="fa fa-check"></i><b>7.2.1</b> Adjusting p-values</a></li>
<li class="chapter" data-level="7.2.2" data-path="clustering-standard-errors.html"><a href="clustering-standard-errors.html#additional-complex-sampling-designs"><i class="fa fa-check"></i><b>7.2.2</b> Additional complex sampling designs</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="compliance.html"><a href="compliance.html"><i class="fa fa-check"></i><b>7.3</b> Compliance</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="compliance.html"><a href="compliance.html#notation-for-compliance"><i class="fa fa-check"></i><b>7.3.1</b> Notation for Compliance</a></li>
<li class="chapter" data-level="7.3.2" data-path="compliance.html"><a href="compliance.html#complier-average-causal-effect"><i class="fa fa-check"></i><b>7.3.2</b> Complier Average Causal Effect</a></li>
<li class="chapter" data-level="7.3.3" data-path="compliance.html"><a href="compliance.html#design-based-approach-to-help-measure-compliance"><i class="fa fa-check"></i><b>7.3.3</b> Design-based approach to help measure compliance</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Experimental Methods in Political Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="clustering-standard-errors" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Clustering standard errors</h2>
<p>Often, we draw a sample of independent observations where randomization occurs at the level of the individual unit. But, sometimes we have multiple observations per unit (e.g., multiple observations of a particular individual, multiple individuals in a household)</p>
<ul>
<li>Example: In Karpowitz et al., precincts are nested within counties. As footnote 15 notes, “The state party relies heavily on county-level party officials to organize and run the neighborhood caucus meetings.”</li>
<li>Consequence: our observations are no longer independent.</li>
<li>Solution: we must account for this in estimates of uncertainty.
<ul>
<li>We are going to “cluster” our standard errors by county</li>
</ul></li>
</ul>
<p>It used to be pretty difficult to do this in R, but over the last few years, people have developed packages to integrate clustering into the standard functions for regression. We will use the package <code>estimatr</code> in this way.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="clustering-standard-errors.html#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;estimatr&quot;</span>)</span></code></pre></div>
<p>Its primary function is <code>lm_robust</code> reflecting its easy integration of different types of “robust” standard errors.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="clustering-standard-errors.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(estimatr)</span>
<span id="cb236-2"><a href="clustering-standard-errors.html#cb236-2" aria-hidden="true" tabindex="-1"></a>r1.cluster <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(prop_sd_fem2014 <span class="sc">~</span> condition, wom,</span>
<span id="cb236-3"><a href="clustering-standard-errors.html#cb236-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">se_type=</span><span class="st">&quot;stata&quot;</span>, <span class="at">clusters =</span> county)</span>
<span id="cb236-4"><a href="clustering-standard-errors.html#cb236-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">summary</span>(r1.cluster)<span class="sc">$</span>coefficients, <span class="at">digits=</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>##                        Estimate Std. Error t value Pr(&gt;|t|) CI Lower CI Upper
## (Intercept)              0.2457     0.0146 16.8311   0.0000   0.2158   0.2756
## conditionSupply          0.0149     0.0155  0.9639   0.3433  -0.0168   0.0466
## conditionDemand          0.0150     0.0214  0.7012   0.4890  -0.0288   0.0589
## conditionSupply+Demand   0.0396     0.0160  2.4805   0.0194   0.0069   0.0723
##                        DF
## (Intercept)            28
## conditionSupply        28
## conditionDemand        28
## conditionSupply+Demand 28</code></pre>
<p>Note how the coefficient estimates remain unchanged, but the size of the standard errors, and therefore, the corresponding t-values and p-values also change.</p>
<div id="adjusting-p-values" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Adjusting p-values</h3>
<p>Another thing we might note about this test is that we are conducting three hypothesis tests simultaneously. This might bring up issue related to multiple comparisons problems. Some of the figures that the authors present include a “Bonferroni” adjustment to the conventional significance levels. When we have multiple hypothesis tests, this can rapidly increase the possibility that we observe at least one significant result, particularly if we assume the tests are independent:</p>
<p><span class="math display">\[\begin{align*}
Pr(\text{at least one significant result}) &amp;= 1 - Pr(\text{no significant result})\\
&amp;= 1 - (1 - 0.05)^{\text{number of tests}}
\end{align*}\]</span></p>
<p>With 3 tests, you have a 14% chance of observing at least one significant result even if all are not significant.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="clustering-standard-errors.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span>)<span class="sc">^</span><span class="dv">3</span></span></code></pre></div>
<pre><code>## [1] 0.142625</code></pre>
<p>We can make an adjustment that makes it harder for us to conclude a result is significant under multiple comparisons. See <a href="https://egap.org/resource/10-things-to-know-about-multiple-comparisons/">EGAP’s resource</a>.</p>
<p>Here are some examples of adjustments using the <code>p.adjust</code> function.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="clustering-standard-errors.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="do">## extract p-values from the regression</span></span>
<span id="cb240-2"><a href="clustering-standard-errors.html#cb240-2" aria-hidden="true" tabindex="-1"></a>pvals <span class="ot">&lt;-</span> <span class="fu">summary</span>(r1.cluster)<span class="sc">$</span>coefficients[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">4</span>]</span>
<span id="cb240-3"><a href="clustering-standard-errors.html#cb240-3" aria-hidden="true" tabindex="-1"></a>pvals</span></code></pre></div>
<pre><code>##        conditionSupply        conditionDemand conditionSupply+Demand 
##             0.34334883             0.48898188             0.01939968</code></pre>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="clustering-standard-errors.html#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="do">## bonferroni-- very conservative</span></span>
<span id="cb242-2"><a href="clustering-standard-errors.html#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(pvals, <span class="at">method=</span><span class="st">&quot;bonferroni&quot;</span>)</span></code></pre></div>
<pre><code>##        conditionSupply        conditionDemand conditionSupply+Demand 
##             1.00000000             1.00000000             0.05819905</code></pre>
<details>
<summary>
The manual approach.
</summary>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="clustering-standard-errors.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="do">## manual (p-vals over 1 switch to 1)</span></span>
<span id="cb244-2"><a href="clustering-standard-errors.html#cb244-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># number of tests</span></span>
<span id="cb244-3"><a href="clustering-standard-errors.html#cb244-3" aria-hidden="true" tabindex="-1"></a>pvals <span class="sc">*</span> <span class="dv">3</span></span></code></pre></div>
<pre><code>##        conditionSupply        conditionDemand conditionSupply+Demand 
##             1.03004649             1.46694564             0.05819905</code></pre>
</details>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="clustering-standard-errors.html#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="do">## holm</span></span>
<span id="cb246-2"><a href="clustering-standard-errors.html#cb246-2" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(pvals, <span class="at">method=</span><span class="st">&quot;holm&quot;</span>)</span></code></pre></div>
<pre><code>##        conditionSupply        conditionDemand conditionSupply+Demand 
##             0.68669766             0.68669766             0.05819905</code></pre>
<details>
<summary>
The manual approach.
</summary>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="clustering-standard-errors.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="do">## manual-- requires pval sorting</span></span>
<span id="cb248-2"><a href="clustering-standard-errors.html#cb248-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># number of tests</span></span>
<span id="cb248-3"><a href="clustering-standard-errors.html#cb248-3" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span> <span class="co"># sequence of rankings</span></span>
<span id="cb248-4"><a href="clustering-standard-errors.html#cb248-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cummax</span>((m <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> i) <span class="sc">*</span> <span class="fu">sort</span>(pvals))</span></code></pre></div>
<pre><code>## conditionSupply+Demand        conditionSupply        conditionDemand 
##             0.05819905             0.68669766             0.68669766</code></pre>
</details>
<p>As you read papers, take note of whether authors make these types of adjustments. There are different philosophies about when one must account for multiple comparisons.</p>
</div>
<div id="additional-complex-sampling-designs" class="section level3" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Additional complex sampling designs</h3>
<p><strong><em>Clustered random assignment</em></strong></p>
<p>Sometimes we go so far as to assign treatment by cluster (e.g., by household, village, school)</p>
<ul>
<li>Consequence: our observations are no longer independent.</li>
<li>Solution: we must account for this in estimates of uncertainty.
<ul>
<li>Caution: if cluster size is correlated with potential outcomes, can bias ATE. See Gerber and Green (2012, 83).</li>
<li>Caution: clustered random assignment can increase uncertainty by decreasing the degrees of freedom (you use this when calculating the p-value from the t distribution)</li>
</ul></li>
</ul>
<p>Why cluster if clustering is not ideal?</p>
<p><strong><em>Blocking</em></strong></p>
<p>Sometimes we assign randomization within specific subgroups instead of at the individual level (Example: Karpowitz et al. replication experiment, pg. 12, where they randomize treatment in their survey experiment by respondent gender and by whether the respondent was from the state above or below average in female representation among Republican state legislators.)</p>
<ul>
<li>Ensures balance across conditions within (blocked) subgroups</li>
<li>Relatedly, avoids need for additional covariate adjustment</li>
<li>Facilitates subgroup analysis by suggesting that is is particularly important to have balance within these subgroups</li>
<li>Sometimes improves precision of estimates</li>
<li>Caution:
<ul>
<li>Affects how to calculate ATEs if assignment probabilities differ by block) See Gerber and Green Chapter 4.5.</li>
<li>Affects calculation of SEs!! See Gerber and Green pgs. 73-74</li>
</ul></li>
</ul>
<p><strong><em>Matched Pairs</em></strong></p>
<p>Matched pairs is a special case of blocking. We find two units OR two clusters of units that are most closely “matched” on pre-treatment covariates</p>
<ul>
<li>Can use matching algorithms to do this</li>
<li>Assign treatment randomly at the pair level, i.e., coin flip as to which unit in the pair receives treatment</li>
<li>Caution: Must take this design into account in analysis. See Gerber and Green (2012, 77)</li>
</ul>
<p>For an experimental application with matched pairs, see “<a href="https://www.cambridge.org/core/journals/american-political-science-review/article/abs/empowering-women-through-development-aid-evidence-from-a-field-experiment-in-afghanistan/2926ACB97A940612C7796E1C70478E15">Empowering Women through Development Aid: Evidence from a Field Experiment in Afghanistan</a>” by Andrew Beath, Christia Fotini, and Ruben Enikolopov publised in <em>The American Political Science Review</em> in 2013. The screenshot below describes the matched pairs process. In the caption of their table of results, they describe how they accounted for matched pairs in the regression.</p>
<p><img src="images/beath1.png" style="width:30.0%" /> <img src="images/beath2.png" style="width:60.0%" /></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="field-experiment-application.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="compliance.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
